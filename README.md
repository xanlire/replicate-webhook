# Webhook для сервиса [Replicate.com](https://replicate.com/)

## Зависимости
- [nodejs/npm latest](https://nodejs.org/en) - окружение для запуска приложения
- [ngrok latest](https://ngrok.com) - реверс-прокси для обеспечения доступа к приложению извне


## Сборка и запуск приложения

Для сборки и запуска приложения необходим инструмент `npm` (см. раздел Зависимости)

```
#Сборка
npm run build
```
```
#Запуск
npm run start:prod
```

По умолчанию приложение запускается на порту 3000

##Развертывание

Для развертывания приложения в тестовом окружении используется инструмент `ngrok` (см. раздел Зависимости)
Необходимо выполнить все указанные по [ссылке](https://ngrok.com/docs/getting-started/) действия для корректной настройки инструмента
После установки, аутентификации, конфигурации необходимо развернуть прокси сервер:
```
#Проксирование приложения во внешнюю сеть
ngrok http 3000 
```

##Описание работы прилжоения

Приложие предоставляет пользователю следующие endpoint'ы:

1. Непосредственно webhook, передваемый сервису Replicate.
```
POST <host>:<port>/replicate/webhook
```

где host, port - значения, получаемые от ngrok при развевртывании прокси сервера.

2. Endpoint для подписки клиентами на событие изменения статуса сирисом Replicate
```
GET <host>:<port>/replicate/webhook/subscribe
```

где host, port - значения, получаемые от ngrok при развевртывании прокси сервера.